(window.webpackJsonp=window.webpackJsonp||[]).push([[13],{435:function(t,e,s){t.exports=s.p+"assets/img/asyncdefer.9edd8d4e.svg"},475:function(t,e,s){"use strict";s.r(e);var a=s(62),n=Object(a.a)({},(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h1",{attrs:{id:"html进阶知识"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#html进阶知识"}},[t._v("#")]),t._v(" html进阶知识")]),t._v(" "),a("h2",{attrs:{id:"src和href属性的区别"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#src和href属性的区别"}},[t._v("#")]),t._v(" src和href属性的区别")]),t._v(" "),a("p",[t._v("部分引用资源的标签中会有src或href属性"),a("br"),t._v("\nhref是Hypertext Reference的简写，表示超文本引用，指向网络资源所在位置，用于在当前文档和引用资源之间确立联系，\n当浏览器遇到href会并行下载资源并且不会停止对当前文档的处理。(同时也是为什么建议使用 link 方式加载 CSS，而不是使用 @import 方式)")]),t._v(" "),a("p",[t._v("src是source的简写，目的是要把文件下载到html页面中去，用于替换当前内容，\n当浏览器解析到src ，会暂停其他资源的下载和处理，直到将该资源加载或执行完毕。(这也是script标签为什么放在底部而不是头部的原因)")]),t._v(" "),a("h2",{attrs:{id:"script标签的async和defer的区别"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#script标签的async和defer的区别"}},[t._v("#")]),t._v(" script标签的async和defer的区别")]),t._v(" "),a("ul",[a("li",[t._v("相同点: 异步加载 (fetch)")]),t._v(" "),a("li",[t._v("不同点:\n"),a("ul",[a("li",[t._v("async 加载(fetch)完成后立即执行 (execution)，因此可能会阻塞 DOM 解析；")]),t._v(" "),a("li",[t._v("defer 加载(fetch)完成后延迟到 DOM 解析完成后才会执行(execution)**，但会在事件 DomContentLoaded 之前")])])])]),t._v(" "),a("p",[a("code",[t._v('<script type="module">')]),t._v("将自动启用严格模式"),a("br"),t._v(" "),a("img",{attrs:{src:s(435),alt:"asyncdefer.svg"}}),a("br"),t._v(" "),a("a",{attrs:{href:"https://html.spec.whatwg.org/multipage/scripting.html#the-script-element",target:"_blank",rel:"noopener noreferrer"}},[t._v("参考文档"),a("OutboundLink")],1)]),t._v(" "),a("h2",{attrs:{id:"图片懒加载的实现方式"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#图片懒加载的实现方式"}},[t._v("#")]),t._v(" 图片懒加载的实现方式")]),t._v(" "),a("ul",[a("li",[t._v("位置计算 + 滚动事件 (Scroll) + DataSet API\n"),a("ul",[a("li",[t._v("window.scroll监听滚动事件")]),t._v(" "),a("li",[t._v("比较元素clientTop，offsetTop，clientHeight 以及 scrollTop等高度判断是否出现在视口中")]),t._v(" "),a("li",[a("code",[t._v('< img data-src="template.jpg"/>')]),t._v(",加载时使用img.src = img.dataset.src即可实现")])])]),t._v(" "),a("li",[t._v("getBoundingClientRect API + Scroll with Throttle + DataSet API实现\n"),a("ul",[a("li",[t._v("Element.getBoundingClientRect()返回元素大小及相对视口的位置")]),t._v(" "),a("li",[t._v("基于上面的方案使用"),a("code",[t._v("img.getBoundingClientRect().top < document.documentElement.clientHeight;")]),t._v("进行判断，给window.scroll加上节流即可")])])]),t._v(" "),a("li",[t._v("IntersectionObserver API + DataSet API实现")])]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// intersectionObserver API 能够监听元素是否达到视口")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" observer "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("IntersectionObserver")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("changes")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// changes: 目标元素集合")]),t._v("\n  changes"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("forEach")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("change")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// intersectionRatio")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("change"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("isIntersecting"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// entry.isIntersecting表示元素是否可见")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" img "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" change"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("target"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n      img"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("src "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" img"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("dataset"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("src"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n      observer"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("unobserve")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("img"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nobserver"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("observe")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("img"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),a("ul",[a("li",[t._v('标签的loading="lazy"属性')])]),t._v(" "),a("h2",{attrs:{id:"xss和csrf攻击"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#xss和csrf攻击"}},[t._v("#")]),t._v(" xss和CSRF攻击")]),t._v(" "),a("p",[t._v("简单理解，举例：在论坛或评论中输入恶意脚本"),a("code",[t._v("<script>恶意脚本<\/script>")]),t._v(",攻击其他查看该网页的用户就是xss。"),a("br"),t._v("\n获取用户token等登录信息，伪造请求破坏用户数据即为CSRF")]),t._v(" "),a("h3",{attrs:{id:"xss攻击"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#xss攻击"}},[t._v("#")]),t._v(" XSS攻击")]),t._v(" "),a("p",[t._v("跨站脚本攻击，攻击者脚本嵌入被攻击网站，攻击用户")]),t._v(" "),a("ul",[a("li",[t._v("存储型：把用户输入的数据“存储”在有漏洞的服务器上，当浏览器访问服务器时，脚本从服务器回传并执行(上例中的xss即为存储型)")]),t._v(" "),a("li",[t._v("反射型：攻击者需要诱使用户点击恶意链接或提交表单，发起恶意请求，web服务器接收到请求时又将请求中的恶意代码反射给浏览器端，web端不会存储恶意代码")]),t._v(" "),a("li",[t._v("基于DOM的XSS攻击：利用web资源传入过程，劫持并修改web页面数据")])]),t._v(" "),a("p",[t._v("防范措施：")]),t._v(" "),a("ul",[a("li",[t._v("服务端对脚本进行过滤或转码")]),t._v(" "),a("li",[t._v("充分利用"),a("a",{attrs:{href:"#csp%E7%AD%96%E7%95%A5"}},[t._v("CSP策略")])]),t._v(" "),a("li",[t._v("使用HttpOnly属性: 服务端设置Cookie时添加HttpOnly标志，保证Cookie不可被js脚本读取")])]),t._v(" "),a("h3",{attrs:{id:"csrf攻击"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#csrf攻击"}},[t._v("#")]),t._v(" CSRF攻击")]),t._v(" "),a("p",[t._v("跨站请求伪造：已登录用户访问攻击者网站，攻击者利用用户的登录状态，向被攻击网站发起恶意请求")]),t._v(" "),a("ul",[a("li",[t._v("自动发起get请求(通过img, script的src属性绕过跨域发起)")]),t._v(" "),a("li",[t._v("自动发起post请求")]),t._v(" "),a("li",[t._v("引诱用户点击链接(钓鱼邮件等方式)")])]),t._v(" "),a("p",[t._v("CSRF不需要将恶意代码注入到用户网页中，只利用用户的登录状态和服务器漏洞进行攻击")]),t._v(" "),a("p",[t._v("防范措施： 主要通过服务器进行防范")]),t._v(" "),a("ul",[a("li",[t._v("设置Cookie的SameSite属性：服务端设置Cookie时，SameSite值，来限制从第三方站点发送请求携带cookie的行为\n"),a("ul",[a("li",[t._v("取Strict时，完全禁止第三方cookie，在a站中请求b站的资源不会携带b站的cookie")]),t._v(" "),a("li",[t._v("取Lax时，a站请求b站资源时，仅get请求会携带b站cookie，post、img、iframe等方式均不会携带b站cookie")]),t._v(" "),a("li",[t._v("取None时，则任何情况下都会携带cookie")])])]),t._v(" "),a("li",[t._v("验证请求来源站点：服务端通过请求头中的origin和referer属性来判断请求是否来自第三方站点")]),t._v(" "),a("li",[t._v("CSRF Token：服务端签发Token，并植入返回页面中，浏览器端发起请求需要带上该Token，服务端对Token进行校验")])]),t._v(" "),a("h2",{attrs:{id:"data-url的优缺点"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#data-url的优缺点"}},[t._v("#")]),t._v(" data-url的优缺点")]),t._v(" "),a("p",[t._v("data-url使用字符串的形式表示数据格式如下"),a("code",[t._v("data:[<mediatype>][;base64],<data>")]),a("br"),t._v("\n在html中用data-url表示图片等体积较小的资源时有如下优缺点："),a("br"),t._v("\n优点：")]),t._v(" "),a("ul",[a("li",[t._v("混合在html内容中可以减少一次http请求")]),t._v(" "),a("li",[t._v("当图片时由服务端动态生成、针对每个用户都不同时，可以使用data url")])]),t._v(" "),a("p",[t._v("缺点：")]),t._v(" "),a("ul",[a("li",[t._v("base64编码的数据体积通常是原数据体积的4/3，增加了资源大小")]),t._v(" "),a("li",[t._v("data url表示的资源不能单独被缓存")]),t._v(" "),a("li",[t._v("data url图片在渲染时需要等多的计算资源")])]),t._v(" "),a("p",[a("a",{attrs:{href:"https://www.cnblogs.com/tianma3798/p/13582105.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("参考文档"),a("OutboundLink")],1)]),t._v(" "),a("h2",{attrs:{id:"csp策略"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#csp策略"}},[t._v("#")]),t._v(" CSP策略")]),t._v(" "),a("p",[t._v("CSP (Content Security Policy) 网页安全政策，浏览器端的白名单制度，限制各类外部资源的加载和执行，可用于防范XSS攻击"),a("br"),t._v("\n启用CSP可通过HTTP响应头的Content-Security-Policy字段或网页的"),a("code",[t._v('<meta http-equiv="Content-Security-Policy">')]),t._v("标签")]),t._v(" "),a("p",[t._v("限制选项：")]),t._v(" "),a("ul",[a("li",[t._v("资源加载限制：\n"),a("ul",[a("li",[a("code",[t._v("script-src")]),t._v("：外部脚本")]),t._v(" "),a("li",[a("code",[t._v("style-src")]),t._v("：样式表")]),t._v(" "),a("li",[a("code",[t._v("img-src")]),t._v("：图像")]),t._v(" "),a("li",[a("code",[t._v("media-src")]),t._v("：媒体文件（音频和视频）")]),t._v(" "),a("li",[a("code",[t._v("font-src")]),t._v("：字体文件")]),t._v(" "),a("li",[a("code",[t._v("object-src")]),t._v("：插件（比如 Flash）")]),t._v(" "),a("li",[a("code",[t._v("child-src")]),t._v("：框架")]),t._v(" "),a("li",[a("code",[t._v("frame-ancestors")]),t._v("：嵌入的外部资源（比如"),a("code",[t._v("<frame>")]),t._v("、"),a("code",[t._v("<iframe>")]),t._v("、"),a("code",[t._v("<embed>")]),t._v("和"),a("code",[t._v("<applet>")]),t._v("）")]),t._v(" "),a("li",[a("code",[t._v("connect-src")]),t._v("：HTTP 连接（通过 XHR、WebSockets、EventSource等）")]),t._v(" "),a("li",[a("code",[t._v("worker-src")]),t._v("：worker脚本")]),t._v(" "),a("li",[a("code",[t._v("manifest-src")]),t._v("：manifest 文件")])])]),t._v(" "),a("li",[t._v("默认选项：\n"),a("ul",[a("li",[a("code",[t._v("default-src")]),t._v(" : 统一设置各选项默认值")])])]),t._v(" "),a("li",[t._v("URL限制：\n"),a("ul",[a("li",[t._v("base-uri：限制"),a("code",[t._v("<base#href>")])]),t._v(" "),a("li",[t._v("form-action：限制"),a("code",[t._v("<form#action>")])])])]),t._v(" "),a("li",[t._v("其他限制：\n"),a("ul",[a("li",[a("code",[t._v("block-all-mixed-content")]),t._v("：HTTPS 网页不得加载 HTTP 资源（浏览器已经默认开启）")]),t._v(" "),a("li",[a("code",[t._v("upgrade-insecure-requests")]),t._v("：自动将网页上所有加载外部资源的 HTTP 链接换成 HTTPS 协议")]),t._v(" "),a("li",[a("code",[t._v("plugin-types")]),t._v("：限制可以使用的插件格式")]),t._v(" "),a("li",[a("code",[t._v("sandbox")]),t._v("：浏览器行为的限制，比如不能有弹出窗口等。")])])]),t._v(" "),a("li",[a("code",[t._v("report uri")]),t._v(": 阻止并报告XSS行为，浏览器会向设置的uri报告受到的XSS攻击详情")])]),t._v(" "),a("p",[a("code",[t._v("script-src")]),t._v("的特殊值：限制行为")]),t._v(" "),a("ul",[a("li",[a("code",[t._v("'unsafe-inline'")]),t._v("：允许执行页面内嵌的"),a("code",[t._v("&lt;script>")]),t._v("标签和事件监听函数")]),t._v(" "),a("li",[a("code",[t._v("unsafe-eval")]),t._v("：允许将字符串当作代码执行，比如使用eval、setTimeout、setInterval和Function等函数。")]),t._v(" "),a("li",[a("code",[t._v("nonce")]),t._v("值：每次HTTP回应给出一个授权token，页面内嵌脚本必须有这个token，才会执行")]),t._v(" "),a("li",[a("code",[t._v("hash")]),t._v("值：列出允许执行的脚本代码的Hash值，页面内嵌脚本的哈希值只有吻合的情况下，才能执行。")])]),t._v(" "),a("p",[a("code",[t._v("script-src")]),t._v("和"),a("code",[t._v("object-src")]),t._v("是必设的，除非设置了"),a("code",[t._v("default-src")]),t._v(", 攻击者只要能注入脚本，其他限制都可以规避"),a("br"),t._v(" "),a("code",[t._v("script-src")]),t._v("不能使用"),a("code",[t._v("unsafe-inline")]),t._v("关键字（除非伴随一个"),a("code",[t._v("nonce")]),t._v("值），也不能允许设置"),a("code",[t._v("data:URL")]),a("br"),t._v("\n必须特别注意 JSONP 的回调函数。")])])}),[],!1,null,null,null);e.default=n.exports}}]);